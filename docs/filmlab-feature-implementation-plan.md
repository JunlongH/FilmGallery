# FilmLab åŠŸèƒ½å®ç°è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2026-01-15  
**çŠ¶æ€**: ğŸ“‹ è§„åˆ’ä¸­  
**ä¼˜å…ˆçº§**: RAW è§£ç  > æ‰¹é‡å¯¼å‡º > HSL > åˆ†ç¦»è‰²è°ƒæ‰©å±• > è‡ªåŠ¨è¾¹ç¼˜æ£€æµ‹

---

## åŠŸèƒ½å®¡è®¡ç»“æœ

### âœ… å·²å®ŒæˆåŠŸèƒ½ (12/17)

| åŠŸèƒ½ | çŠ¶æ€ | ä½ç½® |
|------|------|------|
| èƒ¶ç‰‡åŸºåº•é‡‡æ · | âœ… | FilmLab.jsx - é‡‡æ ·å™¨å·¥å…· |
| RGB é€šé“å¢ç›Š | âœ… | FilmLab.jsx - ç™½å¹³è¡¡é¢æ¿ |
| Log/Tone æ˜ å°„ | âœ… | filmlab-shared - buildToneLUT |
| è‡ªåŠ¨ç™½å¹³è¡¡ | âœ… | FilmLab.jsx - æ»´ç®¡å·¥å…· |
| è‰²æ¸©/è‰²è°ƒ | âœ… | filmLabWhiteBalance.js - Kelvin æ¨¡å‹ |
| æ›²çº¿è°ƒæ•´ | âœ… | filmLabCurves.js - Fritsch-Carlson æ ·æ¡ |
| 3D LUT | âœ… | filmlab-core.js - ä¸‰çº¿æ€§æ’å€¼ |
| èƒ¶ç‰‡é¢„è®¾ | âœ… | filmLabConstants.js - 16 ç§é¢„è®¾ |
| è£å‰ª/æ—‹è½¬ | âœ… | FilmLab.jsx - CropOverlay ç»„ä»¶ |
| æ‰¹é‡é¢„è®¾åº”ç”¨ | âœ… | å·²æœ‰é¢„è®¾ä¿å­˜/åŠ è½½åŠŸèƒ½ |
| Before/After | âœ… | FilmLab.jsx - å¯¹æ¯”æŒ‰é’® |
| H&D å¯†åº¦æ›²çº¿ | âœ… | filmLabCurve.js - applyFilmCurve |

### âš ï¸ éƒ¨åˆ†å®ç° (2/17)

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| åˆ†ç¦»è‰²è°ƒ | âš ï¸ | ä»…äº®åº¦åˆ†ç¦»è°ƒæ•´ï¼Œæ— é«˜å…‰/é˜´å½±ä¸Šè‰² |
| è‡ªåŠ¨è¾¹ç¼˜æ£€æµ‹ | âš ï¸ | ä»…æ‰‹åŠ¨è£å‰ªï¼Œæ— è‡ªåŠ¨åº•ç‰‡è¾¹æ¡†æ£€æµ‹ |

### âŒ æœªå®ç° (3/17)

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| RAW è§£ç  | ğŸ”´ é«˜ | éœ€æ”¯æŒ DNG/CR2/ARW ç­‰æ ¼å¼ |
| HSL è°ƒæ•´ | ğŸ”´ é«˜ | è‰²ç›¸/é¥±å’Œåº¦/æ˜åº¦åˆ†é€šé“è°ƒæ•´ |
| åå°å¯¼å‡ºé˜Ÿåˆ— | ğŸ”´ é«˜ | æ‰¹é‡å¯¼å‡ºä»»åŠ¡ç®¡ç† |

---

## æ¨¡å—å®ç°è®¡åˆ’

### æ¨¡å— 1: RAW è§£ç å™¨ (ä¼˜å…ˆçº§: ğŸ”´ é«˜)

**ç›®æ ‡**: æ”¯æŒæ•°ç ç›¸æœº RAW æ ¼å¼ (DNG, CR2, ARW, NEF, ORF, RAF)

**æ–‡ä»¶ç»“æ„**:
```
server/
  services/
    raw-decoder.js        # RAW è§£ç æœåŠ¡
  routes/
    raw.js                # RAW ç›¸å…³ API ç«¯ç‚¹
packages/shared/
  rawFormats.js           # RAW æ ¼å¼å¸¸é‡å®šä¹‰
```

**æŠ€æœ¯æ–¹æ¡ˆ**:
- ä½¿ç”¨ `dcraw` æˆ– `libraw` (é€šè¿‡ node-addon æˆ– child_process)
- å¤‡é€‰: `sharp` ç»“åˆ `libvips` çš„ RAW æ”¯æŒ
- è¾“å‡º: çº¿æ€§ 16-bit TIFF ä¾›åç»­ Pipeline å¤„ç†

**API è®¾è®¡**:
```javascript
// POST /api/raw/decode
{
  filePath: string,
  options: {
    colorSpace: 'sRGB' | 'AdobeRGB' | 'ProPhotoRGB',
    whiteBalance: 'camera' | 'daylight' | 'custom',
    demosaic: 'AHD' | 'PPG' | 'VNG',
    outputBits: 16
  }
}

// Response
{
  success: true,
  tempPath: '/tmp/raw_decoded_xxx.tiff',
  metadata: { width, height, camera, lens, iso, ... }
}
```

**é¢„è®¡å·¥æ—¶**: 2-3 å¤©

---

### æ¨¡å— 2: HSL è°ƒæ•´ (ä¼˜å…ˆçº§: ğŸ”´ é«˜)

**ç›®æ ‡**: æŒ‰è‰²ç›¸åˆ†åŒºè°ƒæ•´é¥±å’Œåº¦/äº®åº¦/è‰²ç›¸åç§»

**æ–‡ä»¶ç»“æ„**:
```
packages/shared/
  filmLabHSL.js           # HSL è°ƒæ•´ç®—æ³•
client/src/utils/filmlab-shared/
  filmLabHSL.js           # ESM ç‰ˆæœ¬
client/src/components/FilmLab/
  HSLPanel.jsx            # UI ç»„ä»¶
```

**ç®—æ³•è®¾è®¡**:
```javascript
// 8 è‰²ç›¸åˆ†åŒº (çº¢/æ©™/é»„/ç»¿/é’/è“/ç´«/å“çº¢)
const HSL_CHANNELS = {
  red:     { hueCenter: 0,   hueRange: 30 },
  orange:  { hueCenter: 30,  hueRange: 30 },
  yellow:  { hueCenter: 60,  hueRange: 30 },
  green:   { hueCenter: 120, hueRange: 60 },
  cyan:    { hueCenter: 180, hueRange: 30 },
  blue:    { hueCenter: 240, hueRange: 60 },
  purple:  { hueCenter: 270, hueRange: 30 },
  magenta: { hueCenter: 330, hueRange: 30 },
};

// æ¯é€šé“å‚æ•°
{
  hue: -180..180,        // è‰²ç›¸åç§»
  saturation: -100..100, // é¥±å’Œåº¦
  luminance: -100..100   // æ˜åº¦
}
```

**Pipeline ä½ç½®**: åœ¨ Curves ä¹‹åã€3D LUT ä¹‹å‰ (ä½ç½® â‘¥)

**é¢„è®¡å·¥æ—¶**: 1-2 å¤©

---

### æ¨¡å— 3: åˆ†ç¦»è‰²è°ƒæ‰©å±• (ä¼˜å…ˆçº§: ğŸŸ¡ ä¸­)

**ç›®æ ‡**: ä¸ºé«˜å…‰/é˜´å½±åŒºåŸŸæ·»åŠ é¢œè‰²ç€è‰²

**ä¿®æ”¹æ–‡ä»¶**:
```
packages/shared/
  filmLabToneLUT.js       # æ‰©å±•åˆ†ç¦»è‰²è°ƒåŠŸèƒ½
client/src/components/FilmLab/
  SplitToningPanel.jsx    # UI ç»„ä»¶
```

**å‚æ•°è®¾è®¡**:
```javascript
{
  highlights: {
    hue: 0..360,          // é«˜å…‰è‰²ç›¸
    saturation: 0..100,   // é«˜å…‰é¥±å’Œåº¦
    balance: 0..100       // ä½œç”¨èŒƒå›´ (äº®åº¦é˜ˆå€¼)
  },
  shadows: {
    hue: 0..360,          // é˜´å½±è‰²ç›¸
    saturation: 0..100,   // é˜´å½±é¥±å’Œåº¦
    balance: 0..100       // ä½œç”¨èŒƒå›´
  },
  blend: 0..100           // é«˜å…‰/é˜´å½±æ··åˆè¿‡æ¸¡
}
```

**é¢„è®¡å·¥æ—¶**: 1 å¤©

---

### æ¨¡å— 4: è‡ªåŠ¨è¾¹ç¼˜æ£€æµ‹ (ä¼˜å…ˆçº§: ğŸŸ¡ ä¸­)

**ç›®æ ‡**: è‡ªåŠ¨æ£€æµ‹åº•ç‰‡è¾¹æ¡†å¹¶è£å‰ª

**æ–‡ä»¶ç»“æ„**:
```
server/
  services/
    edge-detector.js      # è¾¹ç¼˜æ£€æµ‹æœåŠ¡
packages/shared/
  edgeDetection.js        # è¾¹ç¼˜æ£€æµ‹ç®—æ³•
```

**æŠ€æœ¯æ–¹æ¡ˆ**:
- Canny è¾¹ç¼˜æ£€æµ‹
- Hough å˜æ¢æ£€æµ‹ç›´çº¿
- å››è¾¹å½¢æ‹Ÿåˆæ‰¾åˆ°åº•ç‰‡è¾¹æ¡†

**API è®¾è®¡**:
```javascript
// POST /api/photos/:id/detect-edges
{
  sensitivity: 0..100,    // æ£€æµ‹çµæ•åº¦
  filmFormat: '35mm' | '120' | 'auto'
}

// Response
{
  success: true,
  cropRect: { x, y, w, h },
  confidence: 0.95,
  rotation: -1.5          // å»ºè®®æ—‹è½¬è§’åº¦ (åº¦)
}
```

**é¢„è®¡å·¥æ—¶**: 2-3 å¤©

---

### æ¨¡å— 5: åå°å¯¼å‡ºé˜Ÿåˆ— (ä¼˜å…ˆçº§: ğŸ”´ é«˜)

**ç›®æ ‡**: æ‰¹é‡å¯¼å‡ºæ•´å·ç…§ç‰‡ï¼Œæ”¯æŒåå°å¤„ç†å’Œè¿›åº¦åé¦ˆ

**æ–‡ä»¶ç»“æ„**:
```
server/
  services/
    export-queue.js       # å¯¼å‡ºé˜Ÿåˆ—æœåŠ¡
  routes/
    export.js             # å¯¼å‡º API ç«¯ç‚¹
client/src/components/
  ExportQueuePanel.jsx    # å¯¼å‡ºé˜Ÿåˆ— UI
```

**æŠ€æœ¯æ–¹æ¡ˆ**:
- ä½¿ç”¨ `better-queue` æˆ– `bull` é˜Ÿåˆ—åº“
- WebSocket å®æ—¶è¿›åº¦æ¨é€
- æ”¯æŒæš‚åœ/æ¢å¤/å–æ¶ˆ

**API è®¾è®¡**:
```javascript
// POST /api/export/batch
{
  rollId: number,
  photoIds: number[],     // å¯é€‰ï¼Œä¸ä¼ åˆ™å¯¼å‡ºæ•´å·
  format: 'JPEG' | 'TIFF' | 'PNG',
  quality: 85..100,
  maxWidth: 4000,
  applyPreset: 'preset_id' | null,
  outputDir: string
}

// Response
{
  jobId: 'export_job_xxx',
  totalPhotos: 36,
  status: 'queued'
}

// WebSocket: /ws/export/:jobId
{
  type: 'progress',
  current: 12,
  total: 36,
  currentPhoto: 'IMG_001.jpg',
  status: 'processing'
}
```

**é¢„è®¡å·¥æ—¶**: 2-3 å¤©

---

## æ‰¹é‡å¯¼å‡ºæ¶æ„è®¾è®¡

### å½“å‰é—®é¢˜

FilmLab ç›®å‰åªèƒ½åœ¨ ImageViewer ä¸­å¤„ç†å•å¼ ç…§ç‰‡ã€‚ç”¨æˆ·æ— æ³•ï¼š
1. å¯¹æ•´å·ç…§ç‰‡æ‰¹é‡åº”ç”¨ç›¸åŒå‚æ•°
2. æ‰¹é‡å¯¼å‡ºå¤„ç†åçš„ç…§ç‰‡
3. åœ¨åå°æŒç»­å¯¼å‡ºè€Œä¸é˜»å¡ UI

### è§£å†³æ–¹æ¡ˆ: åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UI Layer (å®¢æˆ·ç«¯)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  RollView (ç…§ç‰‡åˆ—è¡¨)                                         â”‚
â”‚    â””â”€ [Select All] [Apply Preset] [Batch Export]            â”‚
â”‚                                                              â”‚
â”‚  FilmLab (å•å¼ ç¼–è¾‘)                                          â”‚
â”‚    â””â”€ [Save] [Export] [Copy Settings]                       â”‚
â”‚                                                              â”‚
â”‚  ExportQueuePanel (å¯¼å‡ºé˜Ÿåˆ—)                                 â”‚
â”‚    â””â”€ Job 1: Roll #12 - 12/36 (33%)                        â”‚
â”‚    â””â”€ Job 2: Roll #15 - Queued                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Layer (æœåŠ¡ç«¯)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POST /api/export/batch                                      â”‚
â”‚    - åˆ›å»ºæ‰¹é‡å¯¼å‡ºä»»åŠ¡                                        â”‚
â”‚    - è¿”å› jobId                                              â”‚
â”‚                                                              â”‚
â”‚  GET /api/export/jobs                                        â”‚
â”‚    - åˆ—å‡ºæ‰€æœ‰å¯¼å‡ºä»»åŠ¡                                        â”‚
â”‚                                                              â”‚
â”‚  DELETE /api/export/jobs/:jobId                             â”‚
â”‚    - å–æ¶ˆ/åˆ é™¤å¯¼å‡ºä»»åŠ¡                                       â”‚
â”‚                                                              â”‚
â”‚  WS /ws/export/:jobId                                        â”‚
â”‚    - å®æ—¶è¿›åº¦æ¨é€                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Export Queue Service                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ExportQueue (å•ä¾‹)                                          â”‚
â”‚    â”œâ”€ addJob(options) â†’ jobId                               â”‚
â”‚    â”œâ”€ cancelJob(jobId)                                      â”‚
â”‚    â”œâ”€ getJobStatus(jobId)                                   â”‚
â”‚    â””â”€ on('progress', callback)                              â”‚
â”‚                                                              â”‚
â”‚  Worker Pool (å¹¶è¡Œå¤„ç†)                                       â”‚
â”‚    â””â”€ processPhoto(photoId, params, outputPath)             â”‚
â”‚        â”œâ”€ Load original image                               â”‚
â”‚        â”œâ”€ Apply filmlab-core.processPixelArray()            â”‚
â”‚        â”œâ”€ Apply crop/rotation                               â”‚
â”‚        â””â”€ Save to outputPath                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Shared Processing Core                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  packages/shared/filmlab-core.js                             â”‚
â”‚    â””â”€ processPixel() / processPixelArray()                  â”‚
â”‚                                                              â”‚
â”‚  packages/shared/filmLabExport.js (æ–°å¢)                     â”‚
â”‚    â””â”€ buildExportParams(presetId, overrides)                â”‚
â”‚    â””â”€ applyParamsToImage(imagePath, params)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FilmLab æ¥å£è°ƒæ•´

ä¸ºæ”¯æŒæ‰¹é‡å¯¼å‡ºï¼Œéœ€è¦å°† FilmLab çš„å¤„ç†é€»è¾‘ä» UI ç»„ä»¶ä¸­æŠ½ç¦»ï¼š

#### å½“å‰æ¶æ„ (è€¦åˆ)
```
FilmLab.jsx
  â””â”€ handleSave() / handleExport() / handleDownload()
      â””â”€ åŒ…å«å®Œæ•´çš„åƒç´ å¤„ç†å¾ªç¯
```

#### ç›®æ ‡æ¶æ„ (è§£è€¦)
```
client/src/services/
  filmlab-export-service.js   # å¯¼å‡ºæœåŠ¡å°è£…
    â””â”€ exportSingle(photoId, params, options)
    â””â”€ exportBatch(photoIds, params, options)

server/services/
  filmlab-export-service.js   # æœåŠ¡ç«¯å¯¼å‡ºæ ¸å¿ƒ
    â””â”€ processAndExport(photoId, params, outputPath)

packages/shared/
  filmLabExport.js            # å¯¼å‡ºå‚æ•°æ„å»ºå™¨
    â””â”€ buildExportParams(preset, overrides)
    â””â”€ validateExportParams(params)
```

### å‚æ•°æŒä¹…åŒ–

ä¸ºæ”¯æŒ"å¤åˆ¶è®¾ç½®åˆ°å…¶ä»–ç…§ç‰‡"ï¼Œéœ€è¦æ ‡å‡†åŒ–å‚æ•°å­˜å‚¨æ ¼å¼ï¼š

```javascript
// ç…§ç‰‡å¤„ç†å‚æ•° (å­˜å‚¨åœ¨ photo.processing_params JSON å­—æ®µ)
{
  version: 2,                    // å‚æ•°ç‰ˆæœ¬å·
  
  // åè½¬
  inverted: true,
  inversionMode: 'linear',
  filmCurveEnabled: true,
  filmCurveProfile: 'portra400',
  
  // ç™½å¹³è¡¡
  red: 1.0, green: 1.0, blue: 1.0,
  temp: 0, tint: 0,
  
  // è‰²è°ƒ
  exposure: 10, contrast: 5,
  highlights: -20, shadows: 15,
  whites: 0, blacks: 5,
  
  // æ›²çº¿
  curves: { rgb: [...], red: [...], green: [...], blue: [...] },
  
  // HSL (æ–°å¢)
  hsl: {
    red: { hue: 0, saturation: 0, luminance: 0 },
    // ...å…¶ä»–é€šé“
  },
  
  // åˆ†ç¦»è‰²è°ƒ (æ‰©å±•)
  splitToning: {
    highlights: { hue: 40, saturation: 20 },
    shadows: { hue: 220, saturation: 15 },
    balance: 50
  },
  
  // è£å‰ª/æ—‹è½¬
  cropRect: { x: 0, y: 0, w: 1, h: 1 },
  rotation: 0,
  
  // 3D LUT
  lut1: 'lut_id_or_null',
  lut1Intensity: 0.8,
  lut2: null,
  lut2Intensity: 1.0
}
```

---

## å®æ–½è·¯çº¿å›¾

### é˜¶æ®µ 1: åŸºç¡€è®¾æ–½ (1 å‘¨)
- [ ] åˆ›å»º `server/services/export-queue.js`
- [ ] åˆ›å»º `server/routes/export.js`
- [ ] å®ç°åŸºæœ¬çš„é˜Ÿåˆ—å’Œ Worker Pool
- [ ] æ·»åŠ  WebSocket è¿›åº¦æ¨é€

### é˜¶æ®µ 2: æ‰¹é‡å¯¼å‡º UI (3 å¤©)
- [ ] åˆ›å»º `ExportQueuePanel.jsx`
- [ ] åœ¨ RollView æ·»åŠ æ‰¹é‡é€‰æ‹©å’Œå¯¼å‡ºæŒ‰é’®
- [ ] å®ç°è¿›åº¦æ˜¾ç¤ºå’Œä»»åŠ¡ç®¡ç†

### é˜¶æ®µ 3: HSL è°ƒæ•´ (1 å‘¨)
- [ ] å®ç° `filmLabHSL.js` ç®—æ³•
- [ ] åˆ›å»º `HSLPanel.jsx` UI
- [ ] é›†æˆåˆ°å¤„ç†æµæ°´çº¿
- [ ] æ·»åŠ åˆ° WebGL ç€è‰²å™¨

### é˜¶æ®µ 4: RAW æ”¯æŒ (1-2 å‘¨)
- [ ] è¯„ä¼° dcraw vs libraw æ–¹æ¡ˆ
- [ ] å®ç° `raw-decoder.js`
- [ ] åˆ›å»º RAW å¯¼å…¥å‘å¯¼ UI
- [ ] é›†æˆåˆ°ç…§ç‰‡ä¸Šä¼ æµç¨‹

### é˜¶æ®µ 5: è¾¹ç¼˜æ£€æµ‹ (1 å‘¨)
- [ ] å®ç° Canny + Hough ç®—æ³•
- [ ] åˆ›å»ºè¾¹ç¼˜æ£€æµ‹ UI
- [ ] é›†æˆåˆ°è£å‰ªå·¥å…·

---

## é™„å½•

### A. ä¾èµ–åŒ…è¯„ä¼°

| åŠŸèƒ½ | å€™é€‰åŒ… | è¯„ä¼° |
|------|--------|------|
| RAW è§£ç  | dcraw (CLI), libraw (native) | dcraw æ›´ç®€å•ï¼Œlibraw æ›´å¿« |
| ä»»åŠ¡é˜Ÿåˆ— | better-queue, bull, bee-queue | better-queue æ—  Redis ä¾èµ– |
| è¾¹ç¼˜æ£€æµ‹ | opencv4nodejs, jimp | opencv åŠŸèƒ½å¼ºä½†å®‰è£…å¤æ‚ |
| WebSocket | ws, socket.io | ws æ›´è½»é‡ï¼Œå·²æœ‰ä½¿ç”¨ |

### B. æ€§èƒ½åŸºå‡†

| æ“ä½œ | å½“å‰è€—æ—¶ | ç›®æ ‡è€—æ—¶ |
|------|----------|----------|
| å•å¼  HQ Export (4000px) | 2-3 ç§’ | < 2 ç§’ |
| 36 å¼ æ‰¹é‡å¯¼å‡º | N/A | < 2 åˆ†é’Ÿ |
| HSL é¢„è§ˆæ›´æ–° | N/A | < 100ms |

---

**æ–‡æ¡£ç»´æŠ¤è€…**: FilmGallery å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2026-01-15
