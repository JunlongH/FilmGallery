# FilmLab åŠŸèƒ½å®ç°è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2026-01-15  
**çŠ¶æ€**: ï¿½ å®æ–½ä¸­  
**ä¼˜å…ˆçº§**: RAW è§£ç  > æ‰¹é‡å¯¼å‡º > HSL > åˆ†ç¦»è‰²è°ƒæ‰©å±• > è‡ªåŠ¨è¾¹ç¼˜æ£€æµ‹

---

## åŠŸèƒ½å®¡è®¡ç»“æœ

### âœ… å·²å®ŒæˆåŠŸèƒ½ (15/17)

| åŠŸèƒ½ | çŠ¶æ€ | ä½ç½® |
|------|------|------|
| èƒ¶ç‰‡åŸºåº•é‡‡æ · | âœ… | FilmLab.jsx - é‡‡æ ·å™¨å·¥å…· |
| RGB é€šé“å¢ç›Š | âœ… | FilmLab.jsx - ç™½å¹³è¡¡é¢æ¿ |
| Log/Tone æ˜ å°„ | âœ… | filmlab-shared - buildToneLUT |
| è‡ªåŠ¨ç™½å¹³è¡¡ | âœ… | FilmLab.jsx - æ»´ç®¡å·¥å…· |
| è‰²æ¸©/è‰²è°ƒ | âœ… | filmLabWhiteBalance.js - Kelvin æ¨¡å‹ |
| æ›²çº¿è°ƒæ•´ | âœ… | filmLabCurves.js - Fritsch-Carlson æ ·æ¡ |
| 3D LUT | âœ… | filmlab-core.js - ä¸‰çº¿æ€§æ’å€¼ |
| èƒ¶ç‰‡é¢„è®¾ | âœ… | filmLabConstants.js - 16 ç§é¢„è®¾ |
| è£å‰ª/æ—‹è½¬ | âœ… | FilmLab.jsx - CropOverlay ç»„ä»¶ |
| æ‰¹é‡é¢„è®¾åº”ç”¨ | âœ… | å·²æœ‰é¢„è®¾ä¿å­˜/åŠ è½½åŠŸèƒ½ |
| Before/After | âœ… | FilmLab.jsx - å¯¹æ¯”æŒ‰é’® |
| H&D å¯†åº¦æ›²çº¿ | âœ… | filmLabCurve.js - applyFilmCurve |
| **HSL è°ƒæ•´** | âœ… | **filmLabHSL.js - 8 è‰²ç›¸åˆ†åŒº (2026-01-15)** |
| **åˆ†ç¦»è‰²è°ƒ** | âœ… | **filmLabSplitTone.js - é«˜å…‰/é˜´å½±ç€è‰² (2026-01-15)** |
| **åå°å¯¼å‡ºé˜Ÿåˆ—** | âœ… | **export-queue.js + export.js (2026-01-15)** |

### âš ï¸ éƒ¨åˆ†å®ç° (1/17)

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| è‡ªåŠ¨è¾¹ç¼˜æ£€æµ‹ | âš ï¸ | ä»…æ‰‹åŠ¨è£å‰ªï¼Œæ— è‡ªåŠ¨åº•ç‰‡è¾¹æ¡†æ£€æµ‹ |

### âŒ æœªå®ç° (1/17)

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|--------|------|
| RAW è§£ç  | ğŸ”´ é«˜ | éœ€æ”¯æŒ DNG/CR2/ARW ç­‰æ ¼å¼ |

---

## æ¨¡å—å®ç°è®¡åˆ’

### æ¨¡å— 1: RAW è§£ç å™¨ (ä¼˜å…ˆçº§: ğŸ”´ é«˜)

**ç›®æ ‡**: æ”¯æŒæ•°ç ç›¸æœº RAW æ ¼å¼ (DNG, CR2, ARW, NEF, ORF, RAF)

**æ–‡ä»¶ç»“æ„**:
```
server/
  services/
    raw-decoder.js        # RAW è§£ç æœåŠ¡
  routes/
    raw.js                # RAW ç›¸å…³ API ç«¯ç‚¹
packages/shared/
  rawFormats.js           # RAW æ ¼å¼å¸¸é‡å®šä¹‰
```

**æŠ€æœ¯æ–¹æ¡ˆ**:
- ä½¿ç”¨ `dcraw` æˆ– `libraw` (é€šè¿‡ node-addon æˆ– child_process)
- å¤‡é€‰: `sharp` ç»“åˆ `libvips` çš„ RAW æ”¯æŒ
- è¾“å‡º: çº¿æ€§ 16-bit TIFF ä¾›åç»­ Pipeline å¤„ç†

**API è®¾è®¡**:
```javascript
// POST /api/raw/decode
{
  filePath: string,
  options: {
    colorSpace: 'sRGB' | 'AdobeRGB' | 'ProPhotoRGB',
    whiteBalance: 'camera' | 'daylight' | 'custom',
    demosaic: 'AHD' | 'PPG' | 'VNG',
    outputBits: 16
  }
}

// Response
{
  success: true,
  tempPath: '/tmp/raw_decoded_xxx.tiff',
  metadata: { width, height, camera, lens, iso, ... }
}
```

**é¢„è®¡å·¥æ—¶**: 2-3 å¤©

---

### æ¨¡å— 2: HSL è°ƒæ•´ (ä¼˜å…ˆçº§: ğŸ”´ é«˜) âœ… å·²å®Œæˆ

**å®Œæˆæ—¥æœŸ**: 2026-01-15

**å®ç°æ–‡ä»¶**:
- `packages/shared/filmLabHSL.js` - CommonJS ç‰ˆæœ¬
- `client/src/utils/filmlab-shared/filmLabHSL.js` - ESM ç‰ˆæœ¬

**å®ç°åŠŸèƒ½**:
- 8 è‰²ç›¸åˆ†åŒº (çº¢/æ©™/é»„/ç»¿/é’/è“/ç´«/å“çº¢)
- æ¯é€šé“ç‹¬ç«‹çš„è‰²ç›¸åç§»/é¥±å’Œåº¦/æ˜åº¦è°ƒæ•´
- ä½™å¼¦å¹³æ»‘è¿‡æ¸¡ç®—æ³•ï¼Œé¿å…è‰²å¸¦
- RGB â†” HSL é¢œè‰²ç©ºé—´è½¬æ¢
- æ‰¹é‡åƒç´ å¤„ç† `applyHSLToArray()`
- [x] `HSLPanel.jsx` UI ç»„ä»¶ âœ… (2026-01-15)
- [x] é›†æˆåˆ° FilmLabControls å’Œå¤„ç†æµæ°´çº¿ âœ… (2026-01-15)

**å¾…å®Œæˆ**:
- [x] é›†æˆåˆ° WebGL ç€è‰²å™¨ âœ… (2026-01-15)

---

### æ¨¡å— 3: åˆ†ç¦»è‰²è°ƒæ‰©å±• (ä¼˜å…ˆçº§: ğŸŸ¡ ä¸­) âœ… å·²å®Œæˆ

**å®Œæˆæ—¥æœŸ**: 2026-01-15

**å®ç°æ–‡ä»¶**:
- `packages/shared/filmLabSplitTone.js` - CommonJS ç‰ˆæœ¬
- `client/src/utils/filmlab-shared/filmLabSplitTone.js` - ESM ç‰ˆæœ¬

**å®ç°åŠŸèƒ½**:
- é«˜å…‰/é˜´å½±åˆ†åŒºç€è‰²
- è‰²ç›¸/é¥±å’Œåº¦å‚æ•°
- å¹³è¡¡æ»‘å—æ§åˆ¶è¿‡æ¸¡
- 5 ç§é¢„è®¾ (æš–å†·èƒ¶ç‰‡ã€é’æ©™ç”µå½±ã€å¤å¤è¤ªè‰²ç­‰)
- ä½™å¼¦å¹³æ»‘è¿‡æ¸¡ï¼Œé¿å…ç¡¬è¾¹ç•Œ
- [x] `SplitToningPanel.jsx` UI ç»„ä»¶ âœ… (2026-01-15)
- [x] é›†æˆåˆ° FilmLabControls å’Œå¤„ç†æµæ°´çº¿ âœ… (2026-01-15)

---

### æ¨¡å— 4: è‡ªåŠ¨è¾¹ç¼˜æ£€æµ‹ (ä¼˜å…ˆçº§: ğŸŸ¡ ä¸­)

**ç›®æ ‡**: è‡ªåŠ¨æ£€æµ‹åº•ç‰‡è¾¹æ¡†å¹¶è£å‰ª

**æ–‡ä»¶ç»“æ„**:
```
server/
  services/
    edge-detector.js      # è¾¹ç¼˜æ£€æµ‹æœåŠ¡
packages/shared/
  edgeDetection.js        # è¾¹ç¼˜æ£€æµ‹ç®—æ³•
```

**æŠ€æœ¯æ–¹æ¡ˆ**:
- Canny è¾¹ç¼˜æ£€æµ‹
- Hough å˜æ¢æ£€æµ‹ç›´çº¿
- å››è¾¹å½¢æ‹Ÿåˆæ‰¾åˆ°åº•ç‰‡è¾¹æ¡†

**API è®¾è®¡**:
```javascript
// POST /api/photos/:id/detect-edges
{
  sensitivity: 0..100,    // æ£€æµ‹çµæ•åº¦
  filmFormat: '35mm' | '120' | 'auto'
}

// Response
{
  success: true,
  cropRect: { x, y, w, h },
  confidence: 0.95,
  rotation: -1.5          // å»ºè®®æ—‹è½¬è§’åº¦ (åº¦)
}
```

**é¢„è®¡å·¥æ—¶**: 2-3 å¤©

---

### æ¨¡å— 5: åå°å¯¼å‡ºé˜Ÿåˆ— (ä¼˜å…ˆçº§: ğŸ”´ é«˜) âœ… å·²å®Œæˆ

**å®Œæˆæ—¥æœŸ**: 2026-01-15

**å®ç°æ–‡ä»¶**:
- `server/services/export-queue.js` - å¯¼å‡ºé˜Ÿåˆ—æœåŠ¡
- `server/routes/export.js` - REST API ç«¯ç‚¹
- `packages/shared/filmLabExport.js` - å¯¼å‡ºå‚æ•°æ¨¡å—

**å®ç°åŠŸèƒ½**:
- ExportQueue ç±» (EventEmitter)
- Job ç”Ÿå‘½å‘¨æœŸç®¡ç† (add/cancel/pause/resume)
- Worker Pool å¹¶è¡Œå¤„ç†
- WebSocket å®æ—¶è¿›åº¦æ¨é€
- å‚æ•°ç‰ˆæœ¬æ§åˆ¶ä¸è¿ç§»
- å‚æ•°éªŒè¯å’Œåºåˆ—åŒ–

**API ç«¯ç‚¹**:
- `POST /api/export/batch` - åˆ›å»ºæ‰¹é‡å¯¼å‡ºä»»åŠ¡
- `GET /api/export/jobs` - è·å–ä»»åŠ¡åˆ—è¡¨
- `DELETE /api/export/jobs/:jobId` - å–æ¶ˆä»»åŠ¡
- `POST /api/export/jobs/:jobId/pause` - æš‚åœä»»åŠ¡
- `POST /api/export/jobs/:jobId/resume` - æ¢å¤ä»»åŠ¡

**UI é›†æˆ** (2026-01-15):
- [x] `ExportQueuePanel.jsx` UI ç»„ä»¶ âœ…
- [x] åœ¨ RollDetail æ·»åŠ æ‰¹é‡å¯¼å‡ºæŒ‰é’® âœ…
- [x] é›†æˆåˆ° server.js ä¸»è·¯ç”± âœ…

// WebSocket: /ws/export/:jobId
{
  type: 'progress',
  current: 12,
  total: 36,
  currentPhoto: 'IMG_001.jpg',
  status: 'processing'
}
```

**é¢„è®¡å·¥æ—¶**: 2-3 å¤©

---

## æ‰¹é‡å¯¼å‡ºæ¶æ„è®¾è®¡

### å½“å‰é—®é¢˜

FilmLab ç›®å‰åªèƒ½åœ¨ ImageViewer ä¸­å¤„ç†å•å¼ ç…§ç‰‡ã€‚ç”¨æˆ·æ— æ³•ï¼š
1. å¯¹æ•´å·ç…§ç‰‡æ‰¹é‡åº”ç”¨ç›¸åŒå‚æ•°
2. æ‰¹é‡å¯¼å‡ºå¤„ç†åçš„ç…§ç‰‡
3. åœ¨åå°æŒç»­å¯¼å‡ºè€Œä¸é˜»å¡ UI

### è§£å†³æ–¹æ¡ˆ: åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     UI Layer (å®¢æˆ·ç«¯)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  RollView (ç…§ç‰‡åˆ—è¡¨)                                         â”‚
â”‚    â””â”€ [Select All] [Apply Preset] [Batch Export]            â”‚
â”‚                                                              â”‚
â”‚  FilmLab (å•å¼ ç¼–è¾‘)                                          â”‚
â”‚    â””â”€ [Save] [Export] [Copy Settings]                       â”‚
â”‚                                                              â”‚
â”‚  ExportQueuePanel (å¯¼å‡ºé˜Ÿåˆ—)                                 â”‚
â”‚    â””â”€ Job 1: Roll #12 - 12/36 (33%)                        â”‚
â”‚    â””â”€ Job 2: Roll #15 - Queued                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Layer (æœåŠ¡ç«¯)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POST /api/export/batch                                      â”‚
â”‚    - åˆ›å»ºæ‰¹é‡å¯¼å‡ºä»»åŠ¡                                        â”‚
â”‚    - è¿”å› jobId                                              â”‚
â”‚                                                              â”‚
â”‚  GET /api/export/jobs                                        â”‚
â”‚    - åˆ—å‡ºæ‰€æœ‰å¯¼å‡ºä»»åŠ¡                                        â”‚
â”‚                                                              â”‚
â”‚  DELETE /api/export/jobs/:jobId                             â”‚
â”‚    - å–æ¶ˆ/åˆ é™¤å¯¼å‡ºä»»åŠ¡                                       â”‚
â”‚                                                              â”‚
â”‚  WS /ws/export/:jobId                                        â”‚
â”‚    - å®æ—¶è¿›åº¦æ¨é€                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Export Queue Service                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ExportQueue (å•ä¾‹)                                          â”‚
â”‚    â”œâ”€ addJob(options) â†’ jobId                               â”‚
â”‚    â”œâ”€ cancelJob(jobId)                                      â”‚
â”‚    â”œâ”€ getJobStatus(jobId)                                   â”‚
â”‚    â””â”€ on('progress', callback)                              â”‚
â”‚                                                              â”‚
â”‚  Worker Pool (å¹¶è¡Œå¤„ç†)                                       â”‚
â”‚    â””â”€ processPhoto(photoId, params, outputPath)             â”‚
â”‚        â”œâ”€ Load original image                               â”‚
â”‚        â”œâ”€ Apply filmlab-core.processPixelArray()            â”‚
â”‚        â”œâ”€ Apply crop/rotation                               â”‚
â”‚        â””â”€ Save to outputPath                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Shared Processing Core                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  packages/shared/filmlab-core.js                             â”‚
â”‚    â””â”€ processPixel() / processPixelArray()                  â”‚
â”‚                                                              â”‚
â”‚  packages/shared/filmLabExport.js (æ–°å¢)                     â”‚
â”‚    â””â”€ buildExportParams(presetId, overrides)                â”‚
â”‚    â””â”€ applyParamsToImage(imagePath, params)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FilmLab æ¥å£è°ƒæ•´

ä¸ºæ”¯æŒæ‰¹é‡å¯¼å‡ºï¼Œéœ€è¦å°† FilmLab çš„å¤„ç†é€»è¾‘ä» UI ç»„ä»¶ä¸­æŠ½ç¦»ï¼š

#### å½“å‰æ¶æ„ (è€¦åˆ)
```
FilmLab.jsx
  â””â”€ handleSave() / handleExport() / handleDownload()
      â””â”€ åŒ…å«å®Œæ•´çš„åƒç´ å¤„ç†å¾ªç¯
```

#### ç›®æ ‡æ¶æ„ (è§£è€¦)
```
client/src/services/
  filmlab-export-service.js   # å¯¼å‡ºæœåŠ¡å°è£…
    â””â”€ exportSingle(photoId, params, options)
    â””â”€ exportBatch(photoIds, params, options)

server/services/
  filmlab-export-service.js   # æœåŠ¡ç«¯å¯¼å‡ºæ ¸å¿ƒ
    â””â”€ processAndExport(photoId, params, outputPath)

packages/shared/
  filmLabExport.js            # å¯¼å‡ºå‚æ•°æ„å»ºå™¨
    â””â”€ buildExportParams(preset, overrides)
    â””â”€ validateExportParams(params)
```

### å‚æ•°æŒä¹…åŒ–

ä¸ºæ”¯æŒ"å¤åˆ¶è®¾ç½®åˆ°å…¶ä»–ç…§ç‰‡"ï¼Œéœ€è¦æ ‡å‡†åŒ–å‚æ•°å­˜å‚¨æ ¼å¼ï¼š

```javascript
// ç…§ç‰‡å¤„ç†å‚æ•° (å­˜å‚¨åœ¨ photo.processing_params JSON å­—æ®µ)
{
  version: 2,                    // å‚æ•°ç‰ˆæœ¬å·
  
  // åè½¬
  inverted: true,
  inversionMode: 'linear',
  filmCurveEnabled: true,
  filmCurveProfile: 'portra400',
  
  // ç™½å¹³è¡¡
  red: 1.0, green: 1.0, blue: 1.0,
  temp: 0, tint: 0,
  
  // è‰²è°ƒ
  exposure: 10, contrast: 5,
  highlights: -20, shadows: 15,
  whites: 0, blacks: 5,
  
  // æ›²çº¿
  curves: { rgb: [...], red: [...], green: [...], blue: [...] },
  
  // HSL (æ–°å¢)
  hsl: {
    red: { hue: 0, saturation: 0, luminance: 0 },
    // ...å…¶ä»–é€šé“
  },
  
  // åˆ†ç¦»è‰²è°ƒ (æ‰©å±•)
  splitToning: {
    highlights: { hue: 40, saturation: 20 },
    shadows: { hue: 220, saturation: 15 },
    balance: 50
  },
  
  // è£å‰ª/æ—‹è½¬
  cropRect: { x: 0, y: 0, w: 1, h: 1 },
  rotation: 0,
  
  // 3D LUT
  lut1: 'lut_id_or_null',
  lut1Intensity: 0.8,
  lut2: null,
  lut2Intensity: 1.0
}
```

---

## å®æ–½è·¯çº¿å›¾

### é˜¶æ®µ 1: åŸºç¡€è®¾æ–½ (1 å‘¨) âœ… å·²å®Œæˆ
- [x] åˆ›å»º `server/services/export-queue.js`
- [x] åˆ›å»º `server/routes/export.js`
- [x] å®ç°åŸºæœ¬çš„é˜Ÿåˆ—å’Œ Worker Pool
- [x] æ·»åŠ  WebSocket è¿›åº¦æ¨é€
- [x] åˆ›å»º `packages/shared/filmLabExport.js` å‚æ•°æ¨¡å—
- [x] åˆ›å»º `packages/shared/filmLabHSL.js` HSL æ¨¡å—
- [x] åˆ›å»º `packages/shared/filmLabSplitTone.js` åˆ†ç¦»è‰²è°ƒæ¨¡å—

### é˜¶æ®µ 2: æ‰¹é‡å¯¼å‡º UI (3 å¤©) âœ… å·²å®Œæˆ
- [x] åˆ›å»º `ExportQueuePanel.jsx` âœ… (2026-01-15)
- [x] åœ¨ RollDetail æ·»åŠ æ‰¹é‡é€‰æ‹©å’Œå¯¼å‡ºæŒ‰é’® âœ… (2026-01-15)
- [x] å®ç°è¿›åº¦æ˜¾ç¤ºå’Œä»»åŠ¡ç®¡ç† âœ… (2026-01-15)

### é˜¶æ®µ 3: HSL è°ƒæ•´ UI (1 å‘¨) âœ… å·²å®Œæˆ
- [x] å®ç° `filmLabHSL.js` ç®—æ³• âœ…
- [x] åˆ›å»º `HSLPanel.jsx` UI âœ… (2026-01-15)
- [x] åˆ›å»º `SplitToningPanel.jsx` UI âœ… (2026-01-15)
- [x] é›†æˆåˆ°å¤„ç†æµæ°´çº¿ (CPU è·¯å¾„) âœ… (2026-01-15)
- [ ] æ·»åŠ åˆ° WebGL ç€è‰²å™¨ (å¾…å®Œæˆ)

### é˜¶æ®µ 4: RAW æ”¯æŒ (1-2 å‘¨) ğŸ“‹ å¾…å¼€å§‹
- [ ] è¯„ä¼° dcraw vs libraw æ–¹æ¡ˆ
- [ ] å®ç° `raw-decoder.js`
- [ ] åˆ›å»º RAW å¯¼å…¥å‘å¯¼ UI
- [ ] é›†æˆåˆ°ç…§ç‰‡ä¸Šä¼ æµç¨‹

### é˜¶æ®µ 5: è¾¹ç¼˜æ£€æµ‹ (1 å‘¨) ğŸ“‹ å¾…å¼€å§‹
- [ ] å®ç° Canny + Hough ç®—æ³•
- [ ] åˆ›å»ºè¾¹ç¼˜æ£€æµ‹ UI
- [ ] é›†æˆåˆ°è£å‰ªå·¥å…·

---

## é™„å½•

### A. ä¾èµ–åŒ…è¯„ä¼°

| åŠŸèƒ½ | å€™é€‰åŒ… | è¯„ä¼° |
|------|--------|------|
| RAW è§£ç  | dcraw (CLI), libraw (native) | dcraw æ›´ç®€å•ï¼Œlibraw æ›´å¿« |
| ä»»åŠ¡é˜Ÿåˆ— | better-queue, bull, bee-queue | better-queue æ—  Redis ä¾èµ– |
| è¾¹ç¼˜æ£€æµ‹ | opencv4nodejs, jimp | opencv åŠŸèƒ½å¼ºä½†å®‰è£…å¤æ‚ |
| WebSocket | ws, socket.io | ws æ›´è½»é‡ï¼Œå·²æœ‰ä½¿ç”¨ |

### B. æ€§èƒ½åŸºå‡†

| æ“ä½œ | å½“å‰è€—æ—¶ | ç›®æ ‡è€—æ—¶ |
|------|----------|----------|
| å•å¼  HQ Export (4000px) | 2-3 ç§’ | < 2 ç§’ |
| 36 å¼ æ‰¹é‡å¯¼å‡º | N/A | < 2 åˆ†é’Ÿ |
| HSL é¢„è§ˆæ›´æ–° | N/A | < 100ms |

---

### C. æ¸²æŸ“é“¾è·¯ç»Ÿä¸€åˆ†æä¸å»ºè®® (2026-01-15 æ–°å¢)

#### å½“å‰é“¾è·¯æ¶æ„é—®é¢˜

FilmLab ç›®å‰å­˜åœ¨ **5 æ¡ç‹¬ç«‹çš„æ¸²æŸ“é“¾è·¯**ï¼Œå„è‡ªå®ç°åƒç´ å¤„ç†é€»è¾‘ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å½“å‰æ¶æ„ (5 æ¡é“¾è·¯)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â‘  Preview (æœåŠ¡ç«¯)                                                 â”‚
â”‚     â””â”€ server/routes/filmlab.js: /preview                          â”‚
â”‚        â””â”€ buildPipeline() + processPixel() â†’ JPEG                  â”‚
â”‚        â””â”€ maxWidth: 1400                                           â”‚
â”‚                                                                    â”‚
â”‚  â‘¡ Preview (å®¢æˆ·ç«¯ WebGL)                                           â”‚
â”‚     â””â”€ FilmLabWebGL.js: processImageWebGL()                        â”‚
â”‚        â””â”€ GLSL ç€è‰²å™¨å¤„ç†                                           â”‚
â”‚        â””â”€ maxWidth: 1200                                           â”‚
â”‚                                                                    â”‚
â”‚  â‘¢ Preview (å®¢æˆ·ç«¯ CPU)                                             â”‚
â”‚     â””â”€ FilmLab.jsx: processImage() CPU åˆ†æ”¯                        â”‚
â”‚        â””â”€ JS pixel loop + processPixel()                           â”‚
â”‚        â””â”€ maxWidth: 1200                                           â”‚
â”‚                                                                    â”‚
â”‚  â‘£ Save/Download (å®¢æˆ·ç«¯)                                          â”‚
â”‚     â””â”€ FilmLab.jsx: handleSave() / downloadClientJPEG()            â”‚
â”‚        â””â”€ JS pixel loop + processPixel()                           â”‚
â”‚        â””â”€ maxWidth: 4000                                           â”‚
â”‚                                                                    â”‚
â”‚  â‘¤ HQ Export (æœåŠ¡ç«¯)                                               â”‚
â”‚     â””â”€ server/routes/filmlab.js: /render, /export                  â”‚
â”‚        â””â”€ buildPipeline() + processPixel() â†’ JPEG                  â”‚
â”‚        â””â”€ maxWidth: 4000                                           â”‚
â”‚                                                                    â”‚
â”‚  â‘¥ GPU Export (Electron ç‹¬ç«‹è¿›ç¨‹)                                   â”‚
â”‚     â””â”€ electron-gpu/gpu-renderer.js                                â”‚
â”‚        â””â”€ ç‹¬ç«‹çš„ WebGL2 ç€è‰²å™¨                                      â”‚
â”‚        â””â”€ ç‹¬ç«‹çš„ computeWBGains() å®ç°                              â”‚
â”‚        â””â”€ maxWidth: åŸå§‹å°ºå¯¸                                        â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å­˜åœ¨çš„é—®é¢˜

| é—®é¢˜ | å½±å“ | ä¸¥é‡ç¨‹åº¦ |
|------|------|----------|
| **ä»£ç é‡å¤** | ç›¸åŒ Pipeline é€»è¾‘åœ¨ 5+ å¤„å®ç° | ğŸ”´ é«˜ |
| **ä¸€è‡´æ€§é£é™©** | ä¿®æ”¹ç®—æ³•éœ€åŒæ­¥å¤šå¤„ï¼Œæ˜“é—æ¼ | ğŸ”´ é«˜ |
| **WB è®¡ç®—ä¸ä¸€è‡´** | gpu-renderer.js æœ‰ç‹¬ç«‹çš„ computeWBGains | ğŸŸ¡ ä¸­ |
| **HSL/åˆ†ç¦»è‰²è°ƒç¼ºå¤±** | æ–°æ¨¡å—éœ€è¦æ·»åŠ åˆ°æ‰€æœ‰ 5 æ¡é“¾è·¯ | ğŸ”´ é«˜ |
| **ç»´æŠ¤æˆæœ¬é«˜** | æ¯æ¬¡è°ƒæ•´éœ€æµ‹è¯•æ‰€æœ‰é“¾è·¯ | ğŸŸ¡ ä¸­ |
| **å‚æ•°ä¼ é€’æ··ä¹±** | å„é“¾è·¯å‚æ•°ç»“æ„ç•¥æœ‰å·®å¼‚ | ğŸŸ¡ ä¸­ |

#### å»ºè®®æ–¹æ¡ˆ: ç»Ÿä¸€æ¸²æŸ“æ ¸å¿ƒ

**ç›®æ ‡**: å°† 5 æ¡é“¾è·¯æ”¶æ•›ä¸º **1 ä¸ªç»Ÿä¸€çš„æ¸²æŸ“æ ¸å¿ƒ + å¤šä¸ªè°ƒç”¨å…¥å£**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç›®æ ‡æ¶æ„ (ç»Ÿä¸€æ ¸å¿ƒ)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   RenderCore (ç»Ÿä¸€æ ¸å¿ƒ)  â”‚                     â”‚
â”‚                    â”‚ packages/shared/render/ â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                 â”‚                                  â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚       â”‚                         â”‚                         â”‚        â”‚
â”‚       â–¼                         â–¼                         â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ CPU     â”‚              â”‚ WebGL   â”‚              â”‚ WebGL2  â”‚     â”‚
â”‚  â”‚ Adapter â”‚              â”‚ Adapter â”‚              â”‚ Adapter â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â”‚
â”‚       â”‚                        â”‚                        â”‚          â”‚
â”‚       â–¼                        â–¼                        â–¼          â”‚
â”‚  æœåŠ¡ç«¯/Node.js            å®¢æˆ·ç«¯é¢„è§ˆ               GPU Export     â”‚
â”‚  (Preview/Export)          (å®æ—¶æ¸²æŸ“)              (Electron)      â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç»Ÿä¸€æ ¸å¿ƒè®¾è®¡

```javascript
// packages/shared/render/RenderCore.js

class RenderCore {
  constructor(params) {
    this.params = this.normalizeParams(params);
    this.luts = null;
  }
  
  // ç»Ÿä¸€å‚æ•°è§„èŒƒåŒ–
  normalizeParams(input) {
    return {
      // åè½¬
      inverted: input.inverted ?? false,
      inversionMode: input.inversionMode ?? 'linear',
      
      // Film Curve
      filmCurveEnabled: input.filmCurveEnabled ?? false,
      filmCurveProfile: input.filmCurveProfile ?? 'default',
      
      // ç™½å¹³è¡¡
      red: input.red ?? 1.0,
      green: input.green ?? 1.0,
      blue: input.blue ?? 1.0,
      temp: input.temp ?? 0,
      tint: input.tint ?? 0,
      
      // è‰²è°ƒ
      exposure: input.exposure ?? 0,
      contrast: input.contrast ?? 0,
      highlights: input.highlights ?? 0,
      shadows: input.shadows ?? 0,
      whites: input.whites ?? 0,
      blacks: input.blacks ?? 0,
      
      // æ›²çº¿
      curves: input.curves ?? DEFAULT_CURVES,
      
      // HSL (æ–°å¢)
      hsl: input.hsl ?? DEFAULT_HSL_PARAMS,
      
      // åˆ†ç¦»è‰²è°ƒ (æ–°å¢)
      splitToning: input.splitToning ?? DEFAULT_SPLIT_TONE_PARAMS,
      
      // 3D LUT
      lut1: input.lut1 ?? null,
      lut2: input.lut2 ?? null,
      
      // å‡ ä½•
      rotation: input.rotation ?? 0,
      orientation: input.orientation ?? 0,
      cropRect: input.cropRect ?? { x: 0, y: 0, w: 1, h: 1 },
    };
  }
  
  // é¢„è®¡ç®—æ‰€æœ‰ LUT
  prepareLUTs() {
    if (this.luts) return this.luts;
    this.luts = prepareLUTs(this.params);
    return this.luts;
  }
  
  // å¤„ç†å•ä¸ªåƒç´  (CPU é€‚é…å™¨ä½¿ç”¨)
  processPixel(r, g, b) {
    return processPixelWithHSL(r, g, b, this.luts, this.params);
  }
  
  // ç”Ÿæˆ GLSL uniform æ•°æ® (WebGL é€‚é…å™¨ä½¿ç”¨)
  getGLSLUniforms() {
    return {
      u_inverted: this.params.inverted ? 1 : 0,
      u_inversionMode: this.params.inversionMode === 'log' ? 1 : 0,
      u_wbGains: computeWBGains(this.params),
      u_toneCurve: this.luts.toneLUT,
      u_rgbCurve: this.luts.lutRGB,
      // ... HSL, Split Toning uniforms
    };
  }
  
  // è·å– Pipeline æè¿° (ç”¨äºè°ƒè¯•)
  getPipelineDescription() {
    return {
      steps: [
        'Film Curve (H&D)',
        'Inversion',
        'White Balance',
        'Tone Mapping',
        'Curves',
        'HSL Adjustment',
        'Split Toning',
        '3D LUT',
      ],
      params: this.params,
    };
  }
}
```

#### é“¾è·¯ç»Ÿä¸€åçš„å…¥å£

```javascript
// 1. æœåŠ¡ç«¯é¢„è§ˆ
const core = new RenderCore(params);
core.prepareLUTs();
for (let i = 0; i < pixels.length; i += 3) {
  const [r, g, b] = core.processPixel(pixels[i], pixels[i+1], pixels[i+2]);
  // ...
}

// 2. å®¢æˆ·ç«¯ WebGL
const core = new RenderCore(params);
const uniforms = core.getGLSLUniforms();
gl.uniform3fv(locations.u_wbGains, uniforms.u_wbGains);
// ... render

// 3. GPU Export (Electron)
// ç›´æ¥ä½¿ç”¨ RenderCore.getGLSLUniforms()
```

#### å®æ–½è®¡åˆ’

| é˜¶æ®µ | å·¥ä½œå†…å®¹ | å·¥æ—¶ | çŠ¶æ€ |
|------|----------|------|--------|
| **Phase 1** | åˆ›å»º RenderCore ç±»ï¼Œæå–å…¬å…±é€»è¾‘ | 1 å¤© | âœ… å®Œæˆ |
| **Phase 2** | HSL/åˆ†ç¦»è‰²è°ƒæ·»åŠ åˆ° WebGL ç€è‰²å™¨ | 0.5 å¤© | âœ… å®Œæˆ |
| **Phase 3** | è¿ç§»æœåŠ¡ç«¯ Preview/Export ä½¿ç”¨ RenderCore | 0.5 å¤© | ğŸ“‹ å¾…å¼€å§‹ |
| **Phase 4** | è¿ç§»å®¢æˆ·ç«¯ CPU è·¯å¾„ | 0.5 å¤© | ğŸ“‹ å¾…å¼€å§‹ |
| **Phase 5** | ç»Ÿä¸€ gpu-renderer.js ä½¿ç”¨ RenderCore | 1 å¤© | ğŸ“‹ å¾…å¼€å§‹ |
| **Phase 6** | å›å½’æµ‹è¯•æ‰€æœ‰é“¾è·¯ä¸€è‡´æ€§ | 1 å¤© | ğŸ“‹ å¾…å¼€å§‹ |

#### ä¸ç«‹å³ä¿®æ”¹çš„åŸå› 

1. **ç³»ç»Ÿå½“å‰ç¨³å®šè¿è¡Œ** - ç°æœ‰é“¾è·¯åŠŸèƒ½æ­£å¸¸ï¼Œæ— ç´§æ€¥ bug
2. **é‡æ„é£é™©é«˜** - æ¶‰åŠ 5 ä¸ªæ¨¡å—ï¼Œéœ€è¦å……åˆ†æµ‹è¯•
3. **ä¼˜å…ˆçº§æ’åº** - UI ç»„ä»¶å’ŒåŠŸèƒ½å®Œå–„ä¼˜å…ˆäºæ¶æ„é‡æ„
4. **æ¸è¿›å¼è¿ç§»** - å¯ä»¥é€æ­¥ç»Ÿä¸€ï¼Œè€Œéä¸€æ¬¡æ€§å¤§æ”¹

#### å»ºè®®æ‰§è¡Œæ—¶æœº

- âœ… **ç°åœ¨**: æ–°å¢åŠŸèƒ½ (HSL/åˆ†ç¦»è‰²è°ƒ) å…ˆæ·»åŠ åˆ°å…±äº«æ¨¡å—ï¼Œå„é“¾è·¯æŒ‰éœ€é›†æˆ
- âœ… **å·²å®Œæˆ**: ç»Ÿä¸€ä»£ç åº“ï¼Œä½¿ç”¨ CRACO å®ç°å®¢æˆ·ç«¯/æœåŠ¡ç«¯å…±äº« (2026-01-15)
- âœ… **å·²å®Œæˆ**: åˆ›å»º RenderCore ç»Ÿä¸€æ ¸å¿ƒ (2026-01-15)
- âœ… **å·²å®Œæˆ**: HSL/åˆ†ç¦»è‰²è°ƒ WebGL ç€è‰²å™¨é›†æˆ (2026-01-15)
- ğŸ”œ **çŸ­æœŸ**: è¿ç§»æœåŠ¡ç«¯ä½¿ç”¨ RenderCore
- ğŸ“… **ä¸­æœŸ**: è¿ç§»å®¢æˆ·ç«¯ CPU è·¯å¾„ä½¿ç”¨ RenderCore
- ğŸ”® **é•¿æœŸ**: å®Œå…¨ç»Ÿä¸€ï¼Œgpu-renderer.js ä½¿ç”¨ RenderCore

---

### D. ä»£ç ç»Ÿä¸€æ¶æ„ (2026-01-15 å®æ–½)

#### é—®é¢˜èƒŒæ™¯

ä¹‹å‰å­˜åœ¨ä¸¤ä»½å‡ ä¹ç›¸åŒçš„ä»£ç ï¼š

| ä½ç½® | æ ¼å¼ | ç”¨é€” |
|------|------|------|
| `packages/shared/` | CommonJS | æœåŠ¡ç«¯ä½¿ç”¨ |
| `client/src/utils/filmlab-shared/` | ES Modules | å®¢æˆ·ç«¯ä½¿ç”¨ (CRA é™åˆ¶) |

æ¯æ¬¡ä¿®æ”¹ç®—æ³•éœ€è¦åŒæ­¥ä¸¤å¤„ï¼Œå®¹æ˜“é—æ¼å¯¼è‡´ä¸ä¸€è‡´ã€‚

#### è§£å†³æ–¹æ¡ˆ

ä½¿ç”¨ **CRACO** (Create React App Configuration Override) è‡ªå®šä¹‰ webpack é…ç½®ï¼š

1. **ç§»é™¤ ModuleScopePlugin** - CRA é»˜è®¤é˜»æ­¢ä» `src/` å¤–éƒ¨å¯¼å…¥
2. **é…ç½®è·¯å¾„åˆ«å** - `@filmgallery/shared` â†’ `packages/shared/`
3. **ä¿æŒ CommonJS æ ¼å¼** - webpack è‡ªåŠ¨å¤„ç† CJS â†’ ESM è½¬æ¢

#### æ–‡ä»¶ç»“æ„

```
FilmGalery/
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ shared/                    # å”¯ä¸€çš„å…±äº«æ¨¡å— (CommonJS)
â”‚       â”œâ”€â”€ index.js               # ç»Ÿä¸€å…¥å£
â”‚       â”œâ”€â”€ filmlab-core.js        # æ ¸å¿ƒå¤„ç†
â”‚       â”œâ”€â”€ filmLabHSL.js          # HSL è°ƒæ•´
â”‚       â”œâ”€â”€ filmLabSplitTone.js    # åˆ†ç¦»è‰²è°ƒ
â”‚       â”œâ”€â”€ render/                # ç»Ÿä¸€æ¸²æŸ“æ ¸å¿ƒ (2026-01-15 æ–°å¢)
â”‚       â”‚   â”œâ”€â”€ index.js
â”‚       â”‚   â””â”€â”€ RenderCore.js      # ç»Ÿä¸€æ¸²æŸ“æ ¸å¿ƒç±»
â”‚       â””â”€â”€ ...
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ craco.config.js            # CRACO é…ç½®
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ components/
â”‚           â””â”€â”€ FilmLab/           # å¯¼å…¥ @filmgallery/shared
â”‚               â”œâ”€â”€ FilmLabWebGL.js # WebGL ç€è‰²å™¨ (å« HSL/åˆ†ç¦»è‰²è°ƒ)
â”‚               â””â”€â”€ ...
â””â”€â”€ server/
    â””â”€â”€ routes/                    # å¯¼å…¥ ../../packages/shared
```

#### ä½¿ç”¨æ–¹å¼

```javascript
// å®¢æˆ·ç«¯ (React)
import { processPixel, DEFAULT_HSL_PARAMS } from '@filmgallery/shared';

// æœåŠ¡ç«¯ (Node.js)
const { processPixel } = require('../../packages/shared');
```

#### ä¼˜åŠ¿

- âœ… **å•ä¸€ä»£ç æº** - åªéœ€ç»´æŠ¤ `packages/shared`
- âœ… **è‡ªåŠ¨åŒæ­¥** - ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆäºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯
- âœ… **ç±»å‹ä¸€è‡´** - ç›¸åŒçš„å‡½æ•°ç­¾åå’Œè¡Œä¸º
- âœ… **æ— éœ€è½¬æ¢** - webpack è‡ªåŠ¨å¤„ç†æ¨¡å—æ ¼å¼

---

**æ–‡æ¡£ç»´æŠ¤è€…**: FilmGallery å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2026-01-15
