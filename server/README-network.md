# FilmGallery 移动端联网说明

本项目的移动 App 通过 HTTP/JSON 访问本机 FilmGallery 服务器，请按下面步骤确认网络配置。

## 1. 服务器端

- 在 PC 上启动 FilmGallery 服务（`server/server.js`）。
- 确认监听地址是 `0.0.0.0`，端口默认为 `4000`。
- 在 PC 浏览器访问：
  - `http://127.0.0.1:4000/api/rolls`
  - 能返回 JSON 即表示后端正常。

## 2. 获取 PC 的可访问 IP

- Windows 终端执行：

```powershell
ipconfig
```

- 找到当前联网网卡的 IPv4 地址，例如：
  - 家用路由：`192.168.x.x`
  - 手机热点：`192.168.43.x` 等。

## 3. 手机与 PC 在同一网络

满足以下任一条件：

- 两者都连在同一个 Wi‑Fi；或
- 手机开热点，PC 连接手机号热点。

确认：

- 在**手机浏览器**访问：

  ```text
  http://<PC-IP>:4000/api/rolls
  ```

  如果能看到 JSON，说明手机 → 服务器 的网络是通的。

## 4. 在 App 中设置 Server URL

- 打开 App → `Settings`：
  - 在 `Server URL` 中填入：

    ```text
    http://<PC-IP>:4000
    ```

  - 例如：`http://192.168.1.5:4000`
- 点击 **Test Connection**：
  - 成功提示：说明配置正确；
  - 失败时，请先对照上面的“手机浏览器测试”排查。

> 注意：如果只输入 IP 或域名，App 会自动补上 `http://` 前缀，但推荐直接写完整地址。

## 5. 安卓系统设置建议

为避免系统/ROM 阻止独立 APK 联网，建议检查：

- 关闭或暂时断开 VPN（状态栏无 `VPN` 图标）。
- 关闭极端省电 / 数据节省模式：
  - 电池/电量设置中，不限制 FilmGallery 后台活动。
  - 数据节省中允许 FilmGallery 使用数据和 WLAN。
- 安全中心 / 手机管家：
  - 在“应用联网权限/防火墙/流量管理”中，允许 FilmGallery 使用移动数据和 WLAN。

## 6. 常见错误说明

### ERR_NETWORK / Status: N/A

- 说明请求在到达服务器前就被系统或网络栈拦截，常见原因：
  - VPN / 防火墙规则拦截了此 App 的流量。
  - ROM 对第三方 APK 的 HTTP 直连有额外限制。
- 建议：
  1. 先确认手机浏览器能访问 `http://<PC-IP>:4000/api/rolls`；
  2. 确认已按第 5 节中的系统设置放宽限制；
  3. 必要时，在另一台 Android 设备上安装同一 APK 做对比测试。

## 7. 进阶：使用 HTTPS（可选）

如果以后需要在公网或复杂网络环境更稳定地访问服务器，建议：

- 为服务器配置一个 HTTPS 入口（自签或使用 Let\'s Encrypt + 域名）；
- 在 App 中使用 `https://` 的地址作为 `Server URL`。

当前版本主要面向局域网/自用场景，默认使用 HTTP，如遇到不能联网但浏览器正常的极端情况，优先检查网络/系统设置。 
